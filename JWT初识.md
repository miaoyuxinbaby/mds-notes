# 如题 Json Web Token

传统的认证用户身份，大多采用的是服务端存session,客户端存session_id、

问题： 在有集群时，需要共享session,则需要引入别的持久层，写入数据库。可扩展性不太好。

## jwt原理

服务端认证后，生成一个json对象(JWT)，每次与服务端交互都带上jwt，用来验证身份。

## jwt结构

header.playload.signature


```js
// header
{
  alg: "签名算法",
  typ: "token type 例如： JWT”
}

// playload 实际传递的数据 也是json
// signature 对前2部分的签名，防止数据篡改。
```

首先，需要指定一个密钥（secret）。这个密钥只有服务器才知道，不能泄露给用户。然后，使用 Header 里面指定的签名算法，将结果的的三个部分用 `.` 分隔，返回给用户

## 缺点

由于服务器不保存 session 状态，因此无法在使用过程中废止某个 token，或者更改 token 的权限。也就是说，一旦 JWT 签发了，在到期之前就会始终有效，除非服务器部署额外的逻辑

JWT 本身包含了认证信息，一旦泄露，任何人都可以获得该令牌的所有权限。为了减少盗用，JWT 的有效期应该设置得比较短。对于一些比较重要的权限，使用时应该再次对用户进行认证。

为了减少盗用，JWT 不应该使用 HTTP 协议明码传输，要使用 HTTPS 协议传输。